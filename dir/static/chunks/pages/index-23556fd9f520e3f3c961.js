(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{2334:function(e,t,i){"use strict";i.d(t,{uZ:function(){return a},QI:function(){return n}});var a=function(e,t,i){return Math.min(Math.max(e,t),i)},n=function(e){var t=e%360;return t<0&&(t+=360),t}},2785:function(e,t,i){"use strict";i.d(t,{Z:function(){return r}});var a=i(4671),n=(i(6486),i(5893)),o=function(){return{dockbox:{mode:"horizontal",children:[{tabs:[{id:"tab1",title:"tab1",content:(0,n.jsx)("div",{children:"Hello World"})}]}]}}},r=(0,a.Z)((function(e){return{currentBreakpoint:"lg",compactType:"horizontal",mounted:!1,layouts:{lg:o()},map:null,markerLayer:null,routeLayer:null,shipsLayer:null,clickControl:null,radarMap:null,radarMarkerLayer:null,radarRouteLayer:null,routePolyLine:null,currentPosition:{lat:-7.115,lng:112.6504},test2Position:{lat:-7.188,lng:112.7135},testPosition:{lat:-7.13,lng:112.67},destinationPosition:{lat:-7.115,lng:112.63},pixelBoatPosition:null,redMapDimensions:null,allowMovement:!1,TileSize:4,boatSpeed:{lat:0,lng:0},boatAngle:0,targetBoatspeed:0,currentBoatspeed:0,aPath:[],aPathDistance:0,departureTime:new Date,arrivalTime:new Date,processedImage:null,Tiles:[],autoDrive:!1,processingRadar:!1,activateAstar:!1,npcShips:null,shipLeftWeight:0,shipRightWeight:0,shipAverageWeight:0,forwardDirection:{x:0,y:0},rightDirection:{x:0,y:0},leftDirection:{x:0,y:0},savedBoundaries:{northEast:{lat:0,lng:0},southWest:{lat:0,lng:0}},mapSetup:function(t,i,a){return e((function(e){return{map:t,markerLayer:i,routeLayer:a}}))},removeAllBears:function(){return e({bears:0})}}}))},8761:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return w}});var a=i(7294),n=(i(2785),i(6486),i(5152)),o=(i(4147),i(8216)),r=i(5997),s=i(4695),l=i(3444),c=i(268),h=i(2953),u=i(2809),g=(i(1272),i(7187));function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,a=(0,h.Z)(e);if(t){var n=(0,h.Z)(this).constructor;i=Reflect.construct(a,arguments,n)}else i=a.apply(this,arguments);return(0,c.Z)(this,i)}}g.EventEmitter;var d=i(2334);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,a=(0,h.Z)(e);if(t){var n=(0,h.Z)(this).constructor;i=Reflect.construct(a,arguments,n)}else i=a.apply(this,arguments);return(0,c.Z)(this,i)}}var v=function(e){(0,l.Z)(i,e);var t=m(i);function i(){var e;return(0,o.Z)(this,i),e=t.call(this),(0,u.Z)((0,s.Z)(e),"indicatorValues",[[0,0,0,0,0],[300,1,21,5,4.5],[600,3,42,10,9],[900,4,63,15,13.5],[1200,5,84,20,18],[1500,6,105,25,22.5],[1800,8,126,30,27],[2100,9,147,35,31.5],[2400,10,168,40,36],[2700,11,189,45,40.5],[3e3,13,210,50,45],[3300,14,231,55,49.5],[3600,15,252,60,54],[3900,16,273,65,58.5],[4200,18,294,70,63],[4500,19,315,75,67.5],[4800,20,336,80,72],[5100,21,357,85,76.5],[5400,23,378,90,90],[5700,24,399,95,85.5],[6e3,25,420,100,90]]),(0,u.Z)((0,s.Z)(e),"handleAutoDrive",(function(){if(e._aPath.length>0){var t=e._aPath.length-2,i={lat:0,lng:0};if(e._aPath.length>=3)t=e._aPath.length-2,i={lat:e._aPath[t].lat,lng:e._aPath[t].lng};else if(2==e._aPath.length)t=0,i={lat:e._aPath[t].lat,lng:e._aPath[t].lng};else{if(1!=e._aPath.length)return void e.stop();var a=e.destPos;i={lat:a.lat,lng:a.lng}}if(e._aPath[e._aPath.length-1]=e.curPos,e.getDistanceFromLatLonInKm(e.curPos.lat,e.curPos.lng,i.lat,i.lng)<=e.tresholdDistance){if(e._aPath.length<=2)return void e.stop();e._aPath.splice(t,1)}else{var n={x:0,y:0};n.x=i.lng-e.curPos.lng,n.y=i.lat-e.curPos.lat;var o=e.boatAngle;e.boatAngle=-1*e.getAngleFromVectorDirection(n),e.getAngleDiffrence(o,e.boatAngle),e.angleMove=e.calcAngle(e.boatAngle),e.boatMove=e.calcSpeed(e.currentBoatSpeed,e.angleMove)}}})),(0,u.Z)((0,s.Z)(e),"handleManualDrive",(function(t){e.boatAngle+=e.manualBoatAngle*t,e.boatAngle=e.boatAngle%360,e.angleMove=e.calcAngle(e.boatAngle),e.boatMove=e.calcSpeed(e.currentBoatSpeed,e.angleMove)})),(0,u.Z)((0,s.Z)(e),"getAngleDiffrence",(function(t,i){if(e.allowMovement){var a=(0,d.QI)(t),n=(0,d.QI)(i)-a;if(Math.abs(n)<=10)return void(e.autoDrive&&e.serialControl.sendCode("ZR"));if(n>180||n<0){var o=(0,d.uZ)(10*Math.round(n/10),10,80)/2;e.autoDrive&&e.serialControl.sendCode("P"+o)}else(0,d.uZ)(10*Math.round(e.makeBetween180(n)/10),10,80)}})),(0,u.Z)((0,s.Z)(e),"makeBetween180",(function(e){return e>180?e=180:e<0&&(e=Math.abs(e)),e})),(0,u.Z)((0,s.Z)(e),"startTimer",(function(){null==e.mainInterval&&(e.mainInterval=setInterval((function(){var t=(Date.now()-e.previousLoopTime)/1e3;if((0!=e.boatMove.lat||0!=e.boatMove.lng)&&e.allowMovement){if(e.autoDrive?e.handleAutoDrive():e.handleManualDrive(t),e.curPos.lat+=e.boatMove.lat*t,e.curPos.lng+=e.boatMove.lng/Math.cos(e.curPos.lat*Math.PI/180)*t,null==e._boundaries.northEast)return;var i=e._boundaries.northEast,a=e._boundaries.southWest,n={lat:0,lng:0};n.lat=(e.curPos.lat-i.lat)/(a.lat-i.lat)*e._processedImage.height,n.lng=(e.curPos.lng-a.lng)/(i.lng-a.lng)*e._processedImage.width;for(var o=n,r={x:0,y:0},s={x:0,y:0},l={x:0,y:0},c=0;c<e._processedImage.width;c+=e._tileSize){s.y=0;for(var h=0;h<e._processedImage.height;h+=e._tileSize)c<=o.lng&&h<=o.lat&&c+e._tileSize>o.lng&&h+e._tileSize>o.lat&&(l.x=c,l.y=h,r.x=s.x,r.y=s.y),s.y++;s.x++}e.boatPixelPos=r,e.calculateSideAngle(r),e.emit("move",{curPos:e.curPos,boatAngle:e.boatAngle,shipLeftWeight:e.shipLeftWeight,shipRightWeight:e.shipRightWeight,shipAverageWeight:e.shipAverageWeight}),e.serialControl.sendData({command:"move",curPos:e.curPos,boatAngle:e.boatAngle,shipLeftWeight:e.shipLeftWeight,shipRightWeight:e.shipRightWeight,shipAverageWeight:e.shipAverageWeight}),e.engineFuel=e.engineFuel-e.fuelConsumtionPerHour/3600*(t/1e3),e.engineLubOil=e.engineLubOil-e.engineLubOilConsumtionPerHour/3600*(t/1e3),e.engineFuel<=0&&(e.stop(),e.emit("fuel",{fuel:e.engineFuel,msg:"Fuel is empty"}))}e.previousLoopTime=Date.now()}),0))})),(0,u.Z)((0,s.Z)(e),"calcAngle",(function(e){var t=0,i=1;return{x:Math.cos(e*Math.PI/180)*t-Math.sin(e*Math.PI/180)*i,y:Math.sin(e*Math.PI/180)*t+Math.cos(e*Math.PI/180)*i}})),(0,u.Z)((0,s.Z)(e),"calcSpeed",(function(e,t){var i=1.852*e*.35502958579881655,a=i/110574,n=i/111320,o={lat:0,lng:0};return o.lat=a*t.y,o.lng=n*t.x,o})),(0,u.Z)((0,s.Z)(e),"accelLoop",(function(t){var i=Date.now()-e.previousAccelerationTime,a=e.currentBoatSpeed+i/1e3*t;if(0!=t){if(t>0&&a>=e.targetBoatSpeed||t<0&&a<=e.targetBoatSpeed)return e.currentBoatSpeed=e.targetBoatSpeed,e.setUpdateData(e.currentBoatSpeed),e.boatMove=e.calcSpeed(e.currentBoatSpeed,e.angleMove),void(null!=e.accelTimeout&&clearTimeout(e.accelTimeout));e.accelTimeout=setTimeout((function(){return e.currentBoatSpeed+=i/1e3*t,e.setUpdateData(e.currentBoatSpeed),e.boatMove=e.calcSpeed(e.currentBoatSpeed,e.angleMove),e.accelLoop(t),function(){null!=e.accelTimeout&&clearTimeout(e.accelTimeout)}}),0),e.previousAccelerationTime=Date.now()}})),(0,u.Z)((0,s.Z)(e),"checkSpeed",(function(){if(e.allowMovement){var t=e.checkSpeedCode();e.autoDrive&&e.serialControl.sendCode(t)}})),(0,u.Z)((0,s.Z)(e),"cleanup",(function(){clearInterval(e.mainInterval)})),(0,u.Z)((0,s.Z)(e),"returnSpeedBasedOnTrim",(function(t){for(var i=0;i<e.indicatorValues.length;i++)if(e.indicatorValues[i][3]>=t)return e.indicatorValues[i][1]})),(0,u.Z)((0,s.Z)(e),"checkSpeedCode",(function(){return 0==e.currentBoatSpeed?"STP":e.currentBoatSpeed>=e.returnSpeedBasedOnTrim(100)?"FLH":e.currentBoatSpeed>=e.returnSpeedBasedOnTrim(75)?"HLH":e.currentBoatSpeed>=e.returnSpeedBasedOnTrim(50)?"SLH":"DSH"})),(0,u.Z)((0,s.Z)(e),"setupDataListener",(function(){e.activateSplitScreenTimeout=setTimeout((function(){e.activateDataListener=!0,e.requestSyncronize(),console.log("Activate split screen")}),1e3)})),(0,u.Z)((0,s.Z)(e),"cancelDataListener",(function(){e.activateSplitScreenTimeout&&clearTimeout(e.activateSplitScreenTimeout),console.log("No, wait. Cancel splitscreen.")})),(0,u.Z)((0,s.Z)(e),"requestSyncronize",(function(){e.serialControl.sendData({command:"syncronizeScreen"})})),(0,u.Z)((0,s.Z)(e),"localSyncronize",(function(t){switch(t){case"EngineIndicator":console.log("Engine Syncro"),e.setUpdateData(e.currentBoatSpeed);break;case"EchoSounder":e.emit("move",{curPos:e.curPos,boatAngle:e.boatAngle,shipLeftWeight:e.shipLeftWeight,shipRightWeight:e.shipRightWeight,shipAverageWeight:e.shipAverageWeight});break;case"Radar":e.emit("move",{curPos:e.curPos,boatAngle:e.boatAngle,shipLeftWeight:e.shipLeftWeight,shipRightWeight:e.shipRightWeight,shipAverageWeight:e.shipAverageWeight}),e.emit("addObstacle",{npcShipLocations:e.npcShipLocations});break;case"TopRightIndicator":e.emit("move",{curPos:e.curPos,boatAngle:e.boatAngle,shipLeftWeight:e.shipLeftWeight,shipRightWeight:e.shipRightWeight,shipAverageWeight:e.shipAverageWeight}),e.serialControl.sendData({command:"TopRightIndicator",arrivalTime:e.arrivalTime,departureTime:e.departureTime,distance:e.distance});break;case"All":e.setUpdateData(e.currentBoatSpeed),e.serialControl.sendData({command:"move",curPos:e.curPos,boatAngle:e.boatAngle,shipLeftWeight:e.shipLeftWeight,shipRightWeight:e.shipRightWeight,shipAverageWeight:e.shipAverageWeight}),e.serialControl.sendData({command:"syncObstacle",npcShipLocations:e.npcShipLocations}),e.serialControl.sendData({command:"TopRightIndicator",arrivalTime:e.arrivalTime,departureTime:e.departureTime,distance:e.distance}),e.serialControl.sendData({command:"echoSounder",shipRightWeight:e.shipRightWeight,shipLeftWeight:e.shipLeftWeight,shipAverageWeight:e.shipAverageWeight})}})),(0,u.Z)((0,s.Z)(e),"emitSynchronizeData",(function(t){switch(t){case"EngineIndicator":console.log("Engine Syncro"),e.setUpdateData(e.currentBoatSpeed);break;case"EchoSounder":e.emit("move",{curPos:e.curPos,boatAngle:e.boatAngle,shipLeftWeight:e.shipLeftWeight,shipRightWeight:e.shipRightWeight,shipAverageWeight:e.shipAverageWeight}),e.serialControl.sendData({command:"echoSounder",shipRightWeight:e.shipRightWeight,shipLeftWeight:e.shipLeftWeight,shipAverageWeight:e.shipAverageWeight});break;case"Radar":e.emit("move",{curPos:e.curPos,boatAngle:e.boatAngle,shipLeftWeight:e.shipLeftWeight,shipRightWeight:e.shipRightWeight,shipAverageWeight:e.shipAverageWeight}),e.serialControl.sendData({command:"move",curPos:e.curPos,boatAngle:e.boatAngle,shipLeftWeight:e.shipLeftWeight,shipRightWeight:e.shipRightWeight,shipAverageWeight:e.shipAverageWeight}),e.serialControl.sendData({command:"addObstacle",npcShipLocations:e.npcShipLocations}),e.serialControl.sendData({command:"removeObstacle",npcShipLocations:e.npcShipLocations});break;case"TopRightIndicator":e.serialControl.sendData({command:"move",curPos:e.curPos,boatAngle:e.boatAngle,shipLeftWeight:e.shipLeftWeight,shipRightWeight:e.shipRightWeight,shipAverageWeight:e.shipAverageWeight}),e.serialControl.sendData({command:"TopRightIndicator",arrivalTime:e.arrivalTime,departureTime:e.departureTime,distance:e.distance});break;case"All":e.setUpdateData(e.currentBoatSpeed),e.serialControl.sendData({command:"move",curPos:e.curPos,boatAngle:e.boatAngle,shipLeftWeight:e.shipLeftWeight,shipRightWeight:e.shipRightWeight,shipAverageWeight:e.shipAverageWeight}),e.serialControl.sendData({command:"syncObstacle",npcShipLocations:e.npcShipLocations}),e.serialControl.sendData({command:"TopRightIndicator",arrivalTime:e.arrivalTime,departureTime:e.departureTime,distance:e.distance}),e.serialControl.sendData({command:"echoSounder",shipRightWeight:e.shipRightWeight,shipLeftWeight:e.shipLeftWeight,shipAverageWeight:e.shipAverageWeight})}})),e.boatAngle=0,e.boatMove={lat:0,lng:0},e.angleMove=e.calcAngle(e.boatAngle),e.manualBoatAngle=0,e.manualBoatSpeedMultiplier=0,e.autoDrive=!1,e.targetBoatSpeed=0,e.currentBoatSpeed=0,e.curPos={lat:-7.110957167609007,lng:112.65547490931478},e.destPos={lat:-7.115,lng:112.63},e.mainInterval=null,e.accelTimeout=null,e.allowMovement=!1,e.previousLoopTime=Date.now(),e.previousAccelerationTime=Date.now(),e.acceleration=0,e.engineFuel=100,e.engineLubOil=100,e.engineOilPressure={previous:[0,0],current:[0,0]},e.engineTrim={previous:[0,0],current:[0,0]},e.engineRPM={previous:[0,0],current:[0,0]},e.engineTemperature={previous:[0,0],current:[0,0]},e.fuelConsumtionPerHour=15,e.engineLubOilConsumtionPerHour=5,e.distance=0,e.arrivalTime=Date.now(),e.departureTime=Date.now(),e.npcShipLocations=[],e.forwardDirection={x:0,y:0},e.rightDirection={x:0,y:0},e.leftDirection={x:0,y:0},e.shipLeftWeight=0,e.shipRightWeight=0,e.shipAverageWeight=0,e.boatPixelPos={x:0,y:0},e.previousIntervalDate=Date.now(),e.serialControl=null,e._tileSize=4,e.clickControl="",e.tresholdDistance=.005,e._aPath=[],e.activateDataListener=!1,e.smallGradualTurnSpeed=5,e.largeGradualTurnSpeed=10,e.maxBoatSpeed=25,e.mapStaticObstacle=[],e.radarStaticObstacle=[],e.activateSplitScreenTimeout=null,e.maximized=!1,e.radarListeners=[],e.mapListeners=[],e.engineListeners=[],e.echoListeners=[],e}return(0,r.Z)(i,[{key:"activateMaximizeMinimize",value:function(){this.maximized=!this.maximized}},{key:"addMapObstacle",value:function(e){this.mapStaticObstacle.push(e)}},{key:"resetMapObstacle",value:function(){this.mapStaticObstacle=[]}},{key:"addRadarObstacle",value:function(e){this.radarStaticObstacle.push(e)}},{key:"resetRadarObstacle",value:function(){this.radarStaticObstacle=[]}},{key:"initialize",value:function(e){e.tileSize;var t=e.tiles,i=e.boundaries,a=e.imageData,n=e.aPath;null!=t&&(this._tiles=t),null!=i&&(this._boundaries=i),null!=a&&(this._processedImage=a),null!=n&&(this._aPath=n)}},{key:"setBoatAutoDrive",value:function(e){this.autoDrive=e}},{key:"getAngleFromVectorDirection",value:function(e){return e=180*Math.atan2(e.x,e.y)/Math.PI}},{key:"getDistanceFromLatLonInKm",value:function(e,t,i,a){var n=this.deg2rad(i-e),o=this.deg2rad(a-t),r=Math.sin(n/2)*Math.sin(n/2)+Math.cos(this.deg2rad(e))*Math.cos(this.deg2rad(i))*Math.sin(o/2)*Math.sin(o/2);return 6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))}},{key:"deg2rad",value:function(e){return e*(Math.PI/180)}},{key:"calculatePathDistance",value:function(e){var t=0;if(e.length>2)for(var i=0;i<e.length-2;i++){var a=e[i],n=e[i+1];t+=this.getDistanceFromLatLonInKm(a.lat,a.lng,n.lat,n.lng)}else{var o=e[0],r=e[1];t+=this.getDistanceFromLatLonInKm(o.lat,o.lng,r.lat,r.lng)}return t}},{key:"manualSteer",value:function(e,t){if(this.allowMovement){switch(t){case"STP":this.manualBoatSpeedMultiplier=0;break;case"DSH":this.manualBoatSpeedMultiplier=.25;break;case"SLH":this.manualBoatSpeedMultiplier=.5;break;case"HLH":this.manualBoatSpeedMultiplier=.75;break;case"FLH":this.manualBoatSpeedMultiplier=1}if("ZR"==e)this.manualBoatAngle=0;else{var i=e.substring(1,e.length),a=e.substring(0,1);this.manualBoatAngle=parseInt(i)/2,"S"==a&&(this.manualBoatAngle=-1*this.manualBoatAngle)}null!=this.accelTimeout&&clearTimeout(this.accelTimeout);var n=this.maxBoatSpeed*this.manualBoatSpeedMultiplier;this.targetBoatSpeed>n?this.acceleration=this.maxBoatSpeed/10*-1:this.acceleration=this.maxBoatSpeed/10,this.targetBoatSpeed=n,this.accelLoop(this.acceleration)}}},{key:"calculateEstimatedArrival",value:function(e){var t=this.targetBoatSpeed;if(t<=0)return 0;return e/(1.852*t)}},{key:"timeToDate",value:function(e){return this.departureTime=Date.now(),this.departureTime+60*e*60*1e3}},{key:"calculateFuelRequirement",value:function(e){var t=1.852*e,i=this.distance/t*this.fuelConsumtionPerHour;this.engineFuel<i&&(this.stop(),console.log("Need "+i.toFixed(2)+", While only have "+this.engineFuel.toFixed(2)),this.emit("fuel",{fuel:this.engineFuel,msg:"Need more fuel "+i.toFixed(2)+"%, While only have fuel "+Math.abs(this.engineFuel.toFixed(2))+"%"}))}},{key:"stop",value:function(){this.allowMovement=!1,this.targetBoatSpeed=0,null!=this.accelTimeout&&clearTimeout(this.accelTimeout),this.acceleration=this.maxBoatSpeed/10*-1,this.resetIntervalsDeltaTime(),this.accelLoop(this.acceleration),this.emit("change",this)}},{key:"start",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.autoDrive=t,this.allowMovement=!0,this.maxBoatSpeed=e,this.autoDrive?this.targetBoatSpeed=this.maxBoatSpeed:this.targetBoatSpeed=this.maxBoatSpeed*this.manualBoatSpeedMultiplier;var i=this.calculatePathDistance(this._aPath),a=this.calculateEstimatedArrival(i);this.distance=i,this.arrivalTime=this.timeToDate(a),this.calculateFuelRequirement(e),this.resetIntervalsDeltaTime(),this.acceleration=this.maxBoatSpeed/10,null!=this.accelTimeout&&clearTimeout(this.accelTimeout),this.accelLoop(this.acceleration),this.emit("updateTopRightIndicatorValues",{curPos:this.curPos,distance:this.distance,departureTime:this.departureTime,arrivalTime:this.arrivalTime}),this.serialControl.sendData({command:"TopRightIndicator",arrivalTime:this.arrivalTime,departureTime:this.departureTime,distance:this.distance}),this.startTimer()}},{key:"resetIntervalsDeltaTime",value:function(){this.previousAccelerationTime=Date.now(),this.previousLoopTime=Date.now()}},{key:"searchIndicatorValues",value:function(e){for(var t=0;t<this.indicatorValues.length;t++)if(this.indicatorValues[t][1]>=e.toFixed(0))return t;return 0}},{key:"setTrim",value:function(e){this.engineTrim={previous:this.engineTrim.current,current:e}}},{key:"setTemperature",value:function(e){this.engineTemperature={previous:this.engineTemperature.current,current:e}}},{key:"setRPM",value:function(e){this.engineRPM={previous:this.engineRPM.current,current:e}}},{key:"setOilPressure",value:function(e){this.engineOilPressure={previous:this.engineOilPressure.current,current:e}}},{key:"setUpdateData",value:function(e){var t=this.searchIndicatorValues(e),i=this.indicatorValues[t],a=this.indicatorValues[this.indicatorValues.length-1];this.setRPM([i[0]/a[0]*100,i[0]/a[0]*100]),this.setOilPressure([i[2]/a[2]*100,i[1]/a[1]*100]),this.setTrim([i[3]/a[3]*100,i[3]/a[3]*100]),this.setTemperature([i[4]/a[4]*100,i[4]/a[4]*100]),this.engineSpeed=e,this.checkSpeed(),this.emit("changeIndicator",{fuel:this.engineFuel,oil:this.engineLubOil,rpm:this.engineRPM,oilPressure:this.engineOilPressure,trim:this.engineTrim,temperature:this.engineTemperature,speed:this.engineSpeed}),this.serialControl.sendData({command:"changeIndicator",fuel:this.engineFuel,oil:this.engineLubOil,rpm:this.engineRPM,oilPressure:this.engineOilPressure,trim:this.engineTrim,temperature:this.engineTemperature,speed:this.engineSpeed})}},{key:"refuel",value:function(){this.emit("refuel"),this.engineFuel=100}},{key:"getSurroundingAverageWeight",value:function(e,t,i){for(var a=e.x>=i?e.x-i:0,n=e.y>=i?e.y-i:0,o=e.x+i>=t.length-1?t.length-1:e.x+i,r=e.y+i>=t[0].length-1?t[0].length-1:e.y+i,s=0,l=(o-a)*(r-n),c=a;c<=o;c++)for(var h=n;h<=r;h++)s+=t[c][h].weight;return s/l}},{key:"clamp",value:function(e,t,i){return Math.min(Math.max(e,t),i)}},{key:"calculateSideAngle",value:function(e){var t=this._tiles;if(null!=t&&null!=e){var i={x:this.clamp(Math.round(this.angleMove.x),-1,1),y:this.clamp(-1*Math.round(this.angleMove.y),-1,1)},a={x:-1*i.y,y:i.x},n={x:i.y,y:-1*i.x},o=t[this.boatPixelPos.x+n.x][this.boatPixelPos.y+n.y].weight,r=t[this.boatPixelPos.x+a.x][this.boatPixelPos.y+a.y].weight,s=this.getSurroundingAverageWeight(this.boatPixelPos,t,3);this.forwardDirection=i,this.rightDirection=a,this.leftDirection=n,this.shipRightWeight=r,this.shipLeftWeight=o,this.shipAverageWeight=s,this.serialControl.sendData({command:"echoSounder",shipRightWeight:r,shipLeftWeight:o,shipAverageWeight:s})}}},{key:"setBoatPosChange",value:function(e){this.curPos=e,this.emit("recalculate"),this.emit("move",{curPos:e,angle:this.boatAngle,shipLeftWeight:this.shipLeftWeight,shipRightWeight:this.shipRightWeight,shipAverageWeight:this.shipAverageWeight}),this.serialControl.sendData({command:"move",curPos:this.curPos,boatAngle:this.boatAngle,shipLeftWeight:this.shipLeftWeight,shipRightWeight:this.shipRightWeight,shipAverageWeight:this.shipAverageWeight})}},{key:"setDestPosChange",value:function(e){this.destPos=e,this.emit("recalculate")}},{key:"setAddShipChange",value:function(e){this.stop(),this.npcShipLocations.push(e),this.emit("addObstacle",{npcShipLocations:this.npcShipLocations}),this.serialControl.sendData({command:"addObstacle",npcShipLocations:this.npcShipLocations})}},{key:"clearObstacles",value:function(){this.stop(),this.npcShipLocations=[],this.emit("removeObstacle"),this.serialControl.sendData({command:"removeObstacle"})}}]),i}(g.EventEmitter),f=i(3794);function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,a=(0,h.Z)(e);if(t){var n=(0,h.Z)(this).constructor;i=Reflect.construct(a,arguments,n)}else i=a.apply(this,arguments);return(0,c.Z)(this,i)}}var b=function(e){(0,l.Z)(i,e);var t=S(i);function i(){var e;return(0,o.Z)(this,i),e=t.call(this),(0,u.Z)((0,s.Z)(e),"sendCode",(function(t){e.socket.emit("change",t.toString().toUpperCase())})),(0,u.Z)((0,s.Z)(e),"sendData",(function(t){e.socket.emit("data",t)})),e.socket=(0,f.io)(),e.socket.connect(),e.socket.on("message",(function(t){null!=t&&""!=t&&e.emit("message",t)})),e.socket.on("data",(function(t){e.emit("data",t)})),e}return i}(g.EventEmitter);function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,a=(0,h.Z)(e);if(t){var n=(0,h.Z)(this).constructor;i=Reflect.construct(a,arguments,n)}else i=a.apply(this,arguments);return(0,c.Z)(this,i)}}var P=function(e){(0,l.Z)(i,e);var t=M(i);function i(){var e;return(0,o.Z)(this,i),e=t.call(this),(0,u.Z)((0,s.Z)(e),"resetRadarMarker",(function(){e.RadarMarkers=[]})),(0,u.Z)((0,s.Z)(e),"setRadarMarker",(function(t){e.RadarMarkers=t})),(0,u.Z)((0,s.Z)(e),"showHideAnimatedBoat",(function(t){e.show=t,e.emit("showHideAnimatedBoat",{show:t}),e.BoatManager.serialControl.sendData({command:"showHideAnimatedBoat",show:t})})),(0,u.Z)((0,s.Z)(e),"startTimer",(function(){console.log(e.timeout),null==e.timeout&&e.checkMovingBoat()})),(0,u.Z)((0,s.Z)(e),"cleanup",(function(){clearTimeout(e.timeout)})),(0,u.Z)((0,s.Z)(e),"checkMovingBoat",(function(){var t=(Date.now()-e.previousLoopTime)/1e3;if(1!=e.BoatManager.activateDataListener){for(var i=[],a=0;a<e.npcMovingShipLocations.length;a++){var n={lat:e.npcMovingShipLocations[a].pos.lat,lng:e.npcMovingShipLocations[a].pos.lng},o=e.npcMovingShipLocations[a].dest,r=e.npcMovingShipLocations[a].currentTarget,s=o[r],l={x:0,y:0};l.x=s.lng-n.lng,l.y=s.lat-n.lat;var c=-1*e.BoatManager.getAngleFromVectorDirection(l),h=e.BoatManager.calcAngle(c),u=e.BoatManager.calcSpeed(25,h);if(n.lat+=u.lat*t,n.lng+=u.lng/Math.cos(u.lat*Math.PI/180)*t,e.npcMovingShipLocations[a].pos=n,e.BoatManager.getDistanceFromLatLonInKm(n.lat,n.lng,s.lat,s.lng)<e.tresholdDistance)switch(e.npcMovingShipLocations[a].routeType){case"Forward":r==o.length-1?(e.npcMovingShipLocations[a].currentTarget=o.length-2,e.npcMovingShipLocations[a].routeType="Backward"):e.npcMovingShipLocations[a].currentTarget++;break;case"Backward":0==r?(e.npcMovingShipLocations[a].currentTarget=1,e.npcMovingShipLocations[a].routeType="Forward"):e.npcMovingShipLocations[a].currentTarget--}i.push({curPos:n,angle:c})}e.emit("moveNPCMarker",{movingBoats:i}),e.BoatManager.serialControl.sendData({command:"moveNPCMarker",movingBoats:i}),e.previousLoopTime=Date.now(),setTimeout((function(){e.checkMovingBoat()}),0)}else null!=e.timeout&&clearTimeout(e.timeout)})),e.previousDate=Date.now(),e.tresholdDistance=.005,e.timeout=null,e.npcMovingShipLocations=[],e.autoNPCBoatRoute=[[{lat:-7.116652110745536,lng:112.6274469651097},{lat:-7.118554967628608,lng:112.65959193976296},{lat:-7.1257216009978706,lng:112.6564991923791},{lat:-7.126660080405161,lng:112.63811452737511},{lat:-7.129987400997364,lng:112.62969538171906}],[{lat:-7.098223034818282,lng:112.68449097241191},{lat:-7.0733084812893905,lng:112.66971451268905}],[{lat:-7.042326035348398,lng:112.66636782648813},{lat:-7.124237331100666,lng:112.6656805492917},{lat:-7.1808840927732005,lng:112.70004440911232},{lat:-7.187708528676055,lng:112.77014668314636}],[{lat:-7.133715410125386,lng:112.67143270568006},{lat:-7.121771167247097,lng:112.66043627053749},{lat:-7.108461501586182,lng:112.66559084951058},{lat:-7.118358469259482,lng:112.68139822502805}],[{lat:-7.104152989915479,lng:112.62963750325109},{lat:-7.102105295610021,lng:112.6576440490049},{lat:-7.106200675100201,lng:112.67740326840176},{lat:-7.096815376457493,lng:112.6969906684995}],[{lat:-7.162679052610708,lng:112.77912029347075},{lat:-7.193730651544236,lng:112.76159472496225}],[{lat:-7.1563212212230685,lng:112.66553336584798},{lat:-7.156662463850766,lng:112.69113444141435}],[{lat:-7.199914977383742,lng:112.77418064654368},{lat:-7.1842190433281,lng:112.77521156233831},{lat:-7.182854153865604,lng:112.69858015493836},{lat:-7.152484304847236,lng:112.6783054776442},{lat:-7.1292790134062045,lng:112.67658728465317},{lat:-7.0992468917527765,lng:112.70270381811682}],[{lat:-7.21868114198483,lng:112.69892379353654},{lat:-7.195138011422208,lng:112.69480013035809},{lat:-7.1842190433281,lng:112.71370025325943},{lat:-7.174323501918634,lng:112.74119134111592}],[{lat:-7.075356303582838,lng:112.64497253361819},{lat:-7.059997415125088,lng:112.65493805296617},{lat:-7.037811454080696,lng:112.65871807754644},{lat:-7.007090680818292,lng:112.65528169156438},{lat:-7.0149417380381,lng:112.69239466017066},{lat:-7.035763465694574,lng:112.67349453726932},{lat:-7.078086719175569,lng:112.667996319698},{lat:-7.0784280199887535,lng:112.65184530558234}]],e.BoatManager=null,e.show=!0,e.RadarMarkers=[],e}return(0,r.Z)(i,[{key:"stop",value:function(){clearTimeout(this.accelTimeout),this.emit("change",this)}},{key:"start",value:function(){this.previousLoopTime=Date.now(),this.startTimer()}},{key:"addMovingNPCShip",value:function(e,t,i){var a={pos:t,dest:i,currentTarget:1,routeType:"Forward"};Array.isArray(i)||(a={pos:t,dest:[t,i],currentTarget:1,routeType:"Forward"});this.npcMovingShipLocations.length<e+1?this.npcMovingShipLocations.push(a):this.npcMovingShipLocations[e]=a}},{key:"changeMovingShipStart",value:function(e,t){this.npcMovingShipLocations[e].pos=t,this.emit("moveNPCMarker",{index:e,curPos:t})}},{key:"changeMovingShipDest",value:function(e,t){this.npcMovingShipLocations[e].dest=t}}]),i}(g.EventEmitter),y=i(5893),T=(0,n.default)((function(){return Promise.all([i.e(269),i.e(874),i.e(937),i.e(228),i.e(351),i.e(358),i.e(925),i.e(611)]).then(i.bind(i,2024))}),{loading:function(){return(0,y.jsx)("p",{children:" Map is loading...."})},ssr:!1,loadableGenerated:{webpack:function(){return[2024]},modules:["index.js -> ../components/live-map/map"]}}),L=(0,n.default)((function(){return Promise.all([i.e(269),i.e(874),i.e(351),i.e(358),i.e(925),i.e(582)]).then(i.bind(i,1442))}),{loading:function(){return(0,y.jsx)("p",{children:" Radar Map is loading...."})},ssr:!1,loadableGenerated:{webpack:function(){return[1442]},modules:["index.js -> ../components/radar/radar-map"]}}),W=(0,n.default)((function(){return Promise.all([i.e(351),i.e(689)]).then(i.bind(i,689))}),{loading:function(){return(0,y.jsx)("p",{children:" Eco Sounder is loading...."})},ssr:!1,loadableGenerated:{webpack:function(){return[689]},modules:["index.js -> ../components/eco-sounder/eco-sounder"]}}),A=(0,n.default)((function(){return Promise.all([i.e(351),i.e(742)]).then(i.bind(i,2742))}),{loading:function(){return(0,y.jsx)("p",{children:" Engine is loading...."})},ssr:!1,loadableGenerated:{webpack:function(){return[2742]},modules:["index.js -> ../components/engine/engine_indicator"]}}),D=(0,n.default)((function(){return i.e(482).then(i.bind(i,5482))}),{loading:function(){return(0,y.jsx)("p",{children:"loading...."})},ssr:!1,loadableGenerated:{webpack:function(){return[5482]},modules:["index.js -> rc-dock"]}}),x=new v,k=new P;k.BoatManager=x;var B=new b;x.serialControl=B;var R={allowWindow:{floatable:!1,newWindow:!1,maximizable:!0,closable:!0,panelExtra:function(e,t){return(0,y.jsxs)("div",{className:"flex flex-row",children:[(0,y.jsx)("span",{className:"my-panel-extra-btn block px-1 m-auto",onClick:function(){x.activateMaximizeMinimize(),t.dockMove(e,null,"maximize")},children:"maximize"===e.parent.mode?"\u25ac":"\u25a3"}),(0,y.jsx)("span",{className:"my-panel-extra-btn block px-1 text-xs m-auto",onClick:function(){return t.dockMove(e,null,"remove")},children:"\u2716"})]})}}};function w(){var e=a.useRef(null),t=(0,a.useState)(100),i=(t[0],t[1]),n=(0,a.useState)(100),o=(n[0],n[1]);(0,a.useEffect)((function(){i(window.innerWidth/2-20),o(window.innerHeight/2-20)}),[]);var r=function(){};return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(D,{ref:e,defaultLayout:{dockbox:{mode:"vertical",children:[{mode:"horizontal",children:[{tabs:[{id:"live_map",group:"allowWindow",title:"Autonomous",content:(0,y.jsx)(T,{serialControl:B,boatManager:x,animatedBoatManager:k,out:r})}]},{tabs:[{id:"radar",group:"allowWindow",title:"Radar",content:(0,y.jsx)(L,{serialControl:B,boatManager:x,animatedBoatManager:k})}]}]},{mode:"horizontal",children:[{tabs:[{id:"eco",group:"allowWindow",title:"Echo Sounder",content:(0,y.jsx)(W,{serialControl:B,boatManager:x})}]},{tabs:[{id:"engine",group:"allowWindow",title:"Engine Indicator",content:(0,y.jsx)(A,{serialControl:B,boatManager:x,engine1:{rotate:30,speed:20},engine2:{rotate:60,speed:30}})}]}]}]}},groups:R,style:{position:"absolute",left:10,top:10,right:10,bottom:10}})})}},8581:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(8761)}])}},function(e){e.O(0,[774,662,4,888,179],(function(){return t=8581,e(e.s=t);var t}));var t=e.O();_N_E=t}]);