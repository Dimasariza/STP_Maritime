"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[582],{1442:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var a=n(2809),r=n(318),o=n(219),i=n(795),l=n(4968),c=n(6584),s=n(1372),u=(n(6538),n(9941),n(4542),n(7294)),d=n(5243),h=n.n(d),g=(n(2785),n(4349)),f=n.n(g),v=(n(4925),n(4891)),b=n(7114),m=n(7516),p=n(5893),w=function(e){var t,n=e.boatManager,o=e.serialControl,i=u.useState({lat:0,lng:0}),l=(0,r.Z)(i,2),c=l[0],s=l[1],d=u.useState(0),h=(0,r.Z)(d,2),g=h[0],f=h[1],v=u.useState(0),b=(0,r.Z)(v,2),w=b[0],x=b[1],j=u.useState(0),y=(0,r.Z)(j,2),k=y[0],S=y[1],O=u.useState("text-sm"),P=(0,r.Z)(O,2),R=P[0],N=P[1],L=(0,u.useRef)();(0,u.useEffect)((function(){n.on("updateTopRightIndicatorValues",(function(e){var t=e.curPos,n=e.distance,a=e.departureTime,r=e.arrivalTime;s(t),f(n),x(a),S(r)})),M(),L.current.checked=!0,n.activateDataListener?n.requestSyncronize("TopRightIndicator"):n.localSyncronize("TopRightIndicator"),n.maximized&&N("text-2xl")}),[]);var M=function(){o.on("data",(function(e){var t=e.command;if(null!=t&&n.activateDataListener)switch(t){case"TopRightIndicator":var a=e.distance,r=e.departureTime,o=e.arrivalTime;if(null==a||null==w||null==o)return;f(a),x(r),S(o);break;case"move":var i=e.curPos;s(i)}}))};function T(e,t){var n=e.toString();return n.length<=t?n:n.substring(0,t)}var C=function(e){var t=e.title,n=e.bars;return(0,p.jsxs)("div",{className:"pb-0.5",children:[(0,p.jsx)("p",{className:"font-sans text-center font-bold ".concat(R," text-gray-200 ..."),children:t}),(0,p.jsx)("div",{children:n.map((function(e){return function(e){var t=e.indicator,n=e.value,a=e.unit;return(0,p.jsxs)("p",{className:"font-sans font-light text-center ".concat(R," text-white ..."),children:[t," ",n," ",a]},t)}(e)}))})]})};function D(e){return new Date(e).toTimeString().split(" ")[0]}function z(e,t){var n=Math.abs(e-t),a=new Date(n).toTimeString().split(" ")[0],r=Array.from(a),o=parseInt(r[0]+r[1])-7,i=Array.from(o);return i.length>1?(r[0]=i[0],r[1]=i[1]):(r[0]="0",r[1]=i[0]),r.join("")}var Z=function(){return C({title:"ETA",bars:[{indicator:null,value:D(k),unit:null}]})},I=function(){return C({title:"ETD",bars:[{indicator:null,value:D(w),unit:null}]})},A=function(){return C({title:"Distance",bars:[{indicator:g.toFixed(2)+"Km",value:"|",unit:z(k,w)}]})},E=function(){return C({title:"Coordinate",bars:[{indicator:"Lat: ",value:T(c.lat,10),unit:null},{indicator:"Lng: ",value:T(c.lng,10),unit:null}]})},B=[(0,p.jsx)("div",{className:"p-1 w-full h-1/6",children:(0,p.jsx)("div",{style:{backgroundImage:"url('./Logo-STP Martitim - ITS.jpeg')",backgroundPositionY:"center",backgroundPositionX:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"},className:"w-full h-full bg-white"})},"logo-stp"),(0,p.jsxs)("div",{className:"flex flex-col flex-1 justify-center items-center",children:[(0,p.jsx)(Z,{}),(0,p.jsx)(I,{}),(0,p.jsx)(A,{}),(0,p.jsx)(E,{})]},"indicator"),(0,p.jsx)("div",{className:"p-1 w-full h-1/6",children:(0,p.jsx)("div",{style:{backgroundImage:"url('./Logo-NASDEC.jpeg')",backgroundPositionY:"center",backgroundPositionX:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain"},className:"w-full h-full bg-white"})},"logo-nasdec")];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"drawer drawer-end absolute z-50 top-0 w-full h-full",children:[(0,p.jsx)("input",{ref:L,id:"my-info",type:"checkbox",className:"drawer-toggle"}),(0,p.jsxs)("div",{className:"drawer-side overflow-hidden h-full",children:[(0,p.jsx)("label",{htmlFor:"my-info",className:"drawer-overlay"}),(0,p.jsx)("div",{className:"w-1/4 flex flex-col overflow-y-auto justify-center items-center bg-black opacity-80 text-base-content",children:B})]})]}),(0,p.jsx)("label",(t={className:"absolute z-50",htmlFor:"my-info"},(0,a.Z)(t,"className","absolute z-50 bottom-0 right-0 btn btn-xs drawer-button"),(0,a.Z)(t,"children",(0,p.jsx)(m.Fs0,{})),t))]})},x=["serialControl","boatManager","animatedBoatManager"];function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(e){var t=e.serialControl,n=e.boatManager,a=e.animatedBoatManager,d=((0,o.Z)(e,x),u.useState({lat:0,lng:0})),g=(0,r.Z)(d,2),m=g[0],j=g[1],k=u.useState(0),S=(0,r.Z)(k,2),O=S[0],P=S[1],R=u.useRef(),N=u.useRef(),L=u.useRef(null),M=u.useRef(null),T=new(h().icon)({iconUrl:"./markerIcons/otherBoat-icon.png",iconSize:new(h().Point)(10,20)}),C=u.useRef(),D=u.useState(null),z=(0,r.Z)(D,2),Z=(z[0],z[1]),I=u.useState({height:"100%",width:"100%"}),A=(0,r.Z)(I,2),E=A[0],B=A[1];(0,u.useEffect)((function(){n.on("move",(function(e){q(e)})),n.on("addObstacle",(function(e){X(e)})),n.on("removeObstacle",(function(e){K(e)})),H(),_(),F(),V(),n.activateDataListener?n.requestSyncronize("Radar"):(j(n.curPos),P(0))}),[]);var W=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n][0],o=new(f())([r.lat,r.lng],{icon:T,draggable:!1});N.current.addLayer(o),t.push(o)}a.setRadarMarker(t)};var F=function(){a.on("showHideAnimatedBoat",(function(e){U(e)}))},_=function(){a.on("moveNPCMarker",(function(e){n.activateDataListener||G(e)}))},H=function(){a.on("addMovingShip",(function(e){}))},V=function(){t.on("data",(function(e){var t=e.command;if(null!=t&&n.activateDataListener)switch(t){case"move":q(e);break;case"addObstacle":X(e);break;case"removeObstacle":K();break;case"showHideAnimatedBoat":U(e);break;case"moveNPCMarker":G(e);break;case"addMovingShip":break;case"syncObstacle":Y(e)}}))},q=function(e){var t=e.curPos,n=e.boatAngle;C.current&&C.current.setView(t),P(n)},X=function(e){var t=e.npcShipLocations;if(null!=t&&n.radarStaticObstacle.length!=t.length&&null!=R.current&&n.radarStaticObstacle.length<t.length){var a=t[t.length-1],r=new(f())([a.lat,a.lng],{icon:T,draggable:!1});R.current.addLayer(r),n.addRadarObstacle(r)}},Y=function(e){var t=e.npcShipLocations;if(null!=t&&null!=R.current)for(var a=0;a<t.length;a++){var r=t[a],o=new(f())([r.lat,r.lng],{icon:T,draggable:!1});R.current.addLayer(o),n.addRadarObstacle(o)}},K=function(){if(null!=R.current){for(var e=0;e<n.radarStaticObstacle.length;e++)R.current.removeLayer(n.radarStaticObstacle[e]);n.resetRadarObstacle()}},U=function(e){var t=e.show;null!=t&&null!=C.current&&null!=N.current&&(t?C.current.addLayer(N.current):C.current.removeLayer(N.current))},G=function(e){var t=e.movingBoats;null!=t&&10==t.length&&(a.RadarMarkers.length!=t.length?J(t):Q(t))},J=function(e){var t=[];console.log("Init moving npc boat."),console.log(e);for(var n=0;n<e.length;n++){console.log("Loop "+(n+1));var r=e[n],o=r.curPos,i=r.angle,l=new(f())([o.lat,o.lng],{icon:T,draggable:!1});N.current.addLayer(l),null!=i&&l.setRotationAngle(-i),t.push(l)}console.log(t),a.setRadarMarker(t)},Q=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=n.curPos,o=n.angle,i=a.RadarMarkers[t];i.slideTo([r.lat,r.lng],{duration:1}),null!=o&&i.setRotationAngle(-o)}};return(0,u.useEffect)((function(){var e=L.current.getContext("2d"),t=M.current.clientHeight,n=M.current.clientWidth;B({height:t,width:n});var a=e.getImageData(0,0,n,t);e.clearRect(0,0,n,t),(0,b.WA)(e,a),e.beginPath(),e.lineWidth=1,e.fillStyle="purple",e.arc(a.width/2,a.height/2,5,0,2*Math.PI),e.fill(),e.beginPath(),e.lineWidth=2,e.strokeStyle="white",e.moveTo(a.width/2,a.height/2),e.lineTo(a.width/2,-a.height),e.stroke(),e.beginPath(),e.lineWidth=1,e.strokeStyle="purple",e.moveTo(a.width/2,a.height/2),e.lineTo(a.width/2,a.height/2-a.height/4),e.stroke()}),[L.current]),(0,p.jsxs)("div",{ref:M,className:"w-full h-full relative",children:[(0,p.jsx)(v.E.div,{className:"absolute",style:{transform:"rotate(0deg)",width:"300%",height:"300%",top:"-100%",left:"-100%"},animate:{transform:"rotate(".concat(O,"deg)")},transition:{duration:.001},children:(0,p.jsxs)(i.h,{zoomControl:!1,attributionControl:!1,whenCreated:function(e){C.current=e,C.current.addLayer(R.current),C.current.addLayer(N.current),Z(e),a.resetRadarMarker(),W(a.autoNPCBoatRoute),n.resetRadarObstacle(),e.setView([m.lat,m.lng]),e.eachLayer((function(e){return console.log(e.options.pane)}))},renderer:h().canvas(),preferCanvas:!0,dragging:!1,center:m,zoom:14,scrollWheelZoom:!1,style:{height:"100%",width:"100%"},children:[(0,p.jsx)(l.et,{position:"topright",children:(0,p.jsx)(l.et.BaseLayer,{checked:!0,name:"Base Map",children:(0,p.jsx)(c.I,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})})}),(0,p.jsx)(l.et.Overlay,{name:"Ships",children:(0,p.jsx)(s.e,{ref:R})}),(0,p.jsx)(l.et.Overlay,{name:"AnimatedShips",children:(0,p.jsx)(s.e,{ref:N})})]})}),(0,p.jsx)("canvas",y(y({ref:L},E),{},{className:"absolute z-40"})),(0,p.jsx)(w,{boatManager:n,serialControl:t})]})}}}]);